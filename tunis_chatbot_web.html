<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TunisBot - Guide Touristique Intelligent</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .chat-container {
            width: 100%;
            max-width: 800px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 90vh;
            max-height: 700px;
        }
        
        .chat-header {
            background: linear-gradient(135deg, #e01e37 0%, #c41230 100%);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        .chat-header h1 {
            font-size: 24px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .chat-header p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f5f5f5;
        }
        
        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message.bot {
            justify-content: flex-start;
        }
        
        .message.user {
            justify-content: flex-end;
        }
        
        .message-bubble {
            max-width: 70%;
            padding: 12px 18px;
            border-radius: 18px;
            word-wrap: break-word;
            white-space: pre-wrap;
            line-height: 1.5;
        }
        
        .message.bot .message-bubble {
            background: white;
            color: #333;
            border-bottom-left-radius: 4px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .message.user .message-bubble {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-bottom-right-radius: 4px;
        }
        
        .message-info {
            font-size: 11px;
            opacity: 0.6;
            margin-top: 5px;
            text-align: right;
        }
        
        .chat-input-container {
            padding: 20px;
            background: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
        }
        
        .chat-input {
            flex: 1;
            padding: 12px 18px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 15px;
            outline: none;
            transition: border-color 0.3s;
        }
        
        .chat-input:focus {
            border-color: #667eea;
        }
        
        .send-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 15px;
            cursor: pointer;
            transition: transform 0.2s;
            font-weight: 600;
        }
        
        .send-button:hover {
            transform: scale(1.05);
        }
        
        .send-button:active {
            transform: scale(0.95);
        }
        
        .quick-questions {
            padding: 15px 20px;
            background: #f9f9f9;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .quick-btn {
            background: white;
            border: 1px solid #ddd;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .quick-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .typing-indicator {
            display: none;
            padding: 10px 18px;
            background: white;
            border-radius: 18px;
            border-bottom-left-radius: 4px;
            max-width: 70px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .typing-indicator.active {
            display: inline-block;
        }
        
        .typing-indicator span {
            height: 8px;
            width: 8px;
            background: #667eea;
            border-radius: 50%;
            display: inline-block;
            margin: 0 2px;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <h1>üèõÔ∏è TunisBot üáπüá≥</h1>
            <p>Votre guide touristique intelligent pour Tunis</p>
        </div>
        
        <div class="quick-questions">
            <button class="quick-btn" onclick="sendQuickQuestion('Quels sont les lieux touristiques?')">üìç Lieux touristiques</button>
            <button class="quick-btn" onclick="sendQuickQuestion('O√π manger √† Tunis?')">üçΩÔ∏è Restaurants</button>
            <button class="quick-btn" onclick="sendQuickQuestion('Comment se d√©placer?')">üöá Transports</button>
            <button class="quick-btn" onclick="sendQuickQuestion('Visite d\'une journ√©e')">üìÖ Itin√©raire</button>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <!-- Messages appara√Ætront ici -->
        </div>
        
        <div class="chat-input-container">
            <input 
                type="text" 
                class="chat-input" 
                id="userInput" 
                placeholder="Posez votre question sur Tunis..."
                onkeypress="handleKeyPress(event)"
            >
            <button class="send-button" onclick="sendMessage()">Envoyer</button>
        </div>
    </div>

    <script>
        // Base de connaissances (m√™me structure que le chatbot Python)
        const knowledgeBase = [
            {
                question: "Quels sont les principaux lieux touristiques √† Tunis?",
                answer: "Les principaux lieux touristiques √† Tunis incluent:\n- La M√©dina de Tunis (class√©e UNESCO)\n- Le site arch√©ologique de Carthage\n- Le village de Sidi Bou Sa√Ød\n- Le Mus√©e National du Bardo\n- La Mosqu√©e Zitouna\n- L'Avenue Habib Bourguiba",
                keywords: ["lieux", "touristiques", "visiter", "voir", "attractions"]
            },
            {
                question: "Que voir dans la M√©dina de Tunis?",
                answer: "Dans la M√©dina de Tunis, vous pouvez visiter:\n- La Mosqu√©e Zitouna (la plus grande mosqu√©e de Tunis)\n- Les souks traditionnels (parfums, tissus, bijoux)\n- Dar Lasram et autres palais ottomans\n- Les m√©dersas historiques\n- Les portes anciennes (Bab El Bhar, Bab Souika)\nC'est un labyrinthe fascinant de ruelles √©troites!",
                keywords: ["m√©dina", "souks", "zitouna", "mosqu√©e"]
            },
            {
                question: "Comment visiter Carthage?",
                answer: "Pour visiter Carthage:\n- Prenez le TGM (train) depuis Tunis Marine jusqu'√† Carthage Hannibal\n- Achetez un billet global pour tous les sites (environ 12 DT)\n- Sites principaux: Thermes d'Antonin, Th√©√¢tre romain, Tophet, Mus√©e de Carthage\n- Comptez une demi-journ√©e √† une journ√©e compl√®te\n- Combinez avec Sidi Bou Sa√Ød tout proche!",
                keywords: ["carthage", "ruines", "thermes", "tgm"]
            },
            {
                question: "Pourquoi visiter Sidi Bou Sa√Ød?",
                answer: "Sidi Bou Sa√Ød est c√©l√®bre pour:\n- Ses maisons blanches et bleues iconiques\n- Ses ruelles pav√©es pittoresques\n- La vue panoramique sur la M√©diterran√©e\n- Le Caf√© des Nattes (th√© √† la menthe et pignons)\n- Les galeries d'art et boutiques d'artisanat\n- L'ambiance boh√®me et artistique\nC'est l'un des plus beaux villages de Tunisie!",
                keywords: ["sidi bou said", "bleu", "blanc", "caf√©", "nattes"]
            },
            {
                question: "O√π manger √† Tunis?",
                answer: "Bonnes adresses √† Tunis:\n- Dar El Jeld (cuisine traditionnelle raffin√©e, M√©dina)\n- Le Baroque (cuisine fusion, La Marsa)\n- Chez Slah (poissons, La Goulette)\n- La Closerie (fran√ßaise, Lac de Tunis)\n- M'rabet (p√¢tisseries, Avenue Habib Bourguiba)\n- Essaraya (traditionnel, Gammarth)",
                keywords: ["manger", "restaurant", "d√Æner", "d√©jeuner", "cuisine"]
            },
            {
                question: "Quelles sp√©cialit√©s tunisiennes go√ªter?",
                answer: "Sp√©cialit√©s incontournables:\n- Couscous (vendredi tradition)\n- Brik √† l'≈ìuf (feuille croustillante)\n- Tajine tunisien (diff√©rent du marocain)\n- Ojja (plat aux ≈ìufs √©pic√©)\n- Lablabi (soupe de pois chiches)\n- Mechouia (salade grill√©e)\n- Makroudh et baklawa (p√¢tisseries)\n- Th√© √† la menthe et pignons",
                keywords: ["sp√©cialit√©s", "plats", "couscous", "brik", "gastronomie"]
            },
            {
                question: "Comment se d√©placer √† Tunis?",
                answer: "Moyens de transport √† Tunis:\n- M√©tro l√©ger (5 lignes, bon march√©)\n- TGM: train de banlieue vers La Marsa/Carthage\n- Bus: r√©seau √©tendu mais souvent bond√©\n- Taxis: jaunes (compteur) ou louages blancs (collectifs)\n- Uber et Bolt: disponibles\n- Location de voiture: pour plus de libert√©\nLe m√©tro est le plus pratique pour le centre-ville.",
                keywords: ["transport", "d√©placer", "m√©tro", "bus", "taxi"]
            },
            {
                question: "Que faire en une journ√©e √† Tunis?",
                answer: "Itin√©raire d'une journ√©e:\nMatin:\n- M√©dina de Tunis et Mosqu√©e Zitouna (2h)\n- Souks et shopping artisanal (1h)\nMidi:\n- D√©jeuner dans la M√©dina\nApr√®s-midi:\n- Mus√©e du Bardo (2h)\n- Avenue Habib Bourguiba (balade)\nSoir:\n- D√Æner √† Sidi Bou Sa√Ød + coucher de soleil\nAlternative: remplacer Bardo par Carthage",
                keywords: ["journ√©e", "itin√©raire", "programme", "jour"]
            },
            {
                question: "Quelle est la meilleure p√©riode pour visiter Tunis?",
                answer: "Meilleures p√©riodes pour visiter Tunis:\n- Printemps (mars-mai): temps doux, 18-25¬∞C, id√©al\n- Automne (septembre-novembre): agr√©able, moins de touristes\n- √ât√© (juin-ao√ªt): chaud (30-35¬∞C), animation, plages\n- Hiver (d√©cembre-f√©vrier): doux mais pluvieux\n√âvitez juillet-ao√ªt si vous n'aimez pas la chaleur intense.",
                keywords: ["p√©riode", "quand", "m√©t√©o", "climat", "saison"]
            }
        ];

        // Variables globales
        let conversationHistory = [];
        
        // Initialisation
        window.onload = function() {
            addBotMessage("Bonjour! Je suis votre guide touristique virtuel pour Tunis. Comment puis-je vous aider √† d√©couvrir notre belle ville? üåü", "rule-based");
        };
        
        // Fonction pour ajouter un message au chat
        function addMessage(text, sender, method = null) {
            const messagesDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const bubbleDiv = document.createElement('div');
            bubbleDiv.className = 'message-bubble';
            bubbleDiv.textContent = text;
            
            messageDiv.appendChild(bubbleDiv);
            
            if (sender === 'bot' && method) {
                const infoDiv = document.createElement('div');
                infoDiv.className = 'message-info';
                infoDiv.textContent = `[${method}]`;
                bubbleDiv.appendChild(infoDiv);
            }
            
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }
        
        function addBotMessage(text, method) {
            addMessage(text, 'bot', method);
        }
        
        function addUserMessage(text) {
            addMessage(text, 'user');
        }
        
        // Pattern matching simple
        function ruleBasedResponse(input) {
            const lower = input.toLowerCase();
            
            if (/\b(bonjour|salut|hey|hello|bonsoir)\b/.test(lower)) {
                return "Bonjour! Je suis votre guide touristique virtuel pour Tunis. Comment puis-je vous aider √† d√©couvrir notre belle ville? üåü";
            }
            if (/\b(au revoir|bye|√† bient√¥t|merci|adieu)\b/.test(lower)) {
                return "Au revoir! J'esp√®re que vous passerez un merveilleux s√©jour √† Tunis. Bon voyage! üåü";
            }
            if (/\b(aide|aider|comment|commencer|que faire)\b/.test(lower)) {
                return "Je peux vous aider avec:\n- Les lieux touristiques (M√©dina, Carthage, Sidi Bou Sa√Ød...)\n- Les restaurants et sp√©cialit√©s culinaires\n- Les transports et infos pratiques\n- L'histoire et la culture\n- Des itin√©raires sugg√©r√©s\n\nPosez-moi une question!";
            }
            if (/\b(qui es-tu|ton nom|tu es qui|c'est quoi ton nom)\b/.test(lower)) {
                return "Je suis TunisBot, votre assistant touristique intelligent pour d√©couvrir Tunis et ses merveilles! üáπüá≥";
            }
            
            return null;
        }
        
        // Recherche par mots-cl√©s (simulation de TF-IDF simplifi√©)
        function keywordMatching(input) {
            const lower = input.toLowerCase();
            let bestMatch = null;
            let bestScore = 0;
            
            knowledgeBase.forEach(item => {
                let score = 0;
                item.keywords.forEach(keyword => {
                    if (lower.includes(keyword)) {
                        score += 2;
                    }
                });
                
                // Bonus si le mot est dans la question
                const questionWords = item.question.toLowerCase().split(' ');
                questionWords.forEach(word => {
                    if (word.length > 3 && lower.includes(word)) {
                        score += 1;
                    }
                });
                
                if (score > bestScore) {
                    bestScore = score;
                    bestMatch = item;
                }
            });
            
            if (bestScore >= 2) {
                return bestMatch.answer;
            }
            
            return null;
        }
        
        // R√©ponse par d√©faut
        function fallbackResponse() {
            return "Je ne suis pas s√ªr de bien comprendre votre question. Pourriez-vous la reformuler? Je peux vous renseigner sur:\n- Les sites touristiques (M√©dina, Carthage, Sidi Bou Sa√Ød)\n- Les restaurants et la gastronomie tunisienne\n- Les transports et informations pratiques\n- L'histoire et la culture\n- Des suggestions d'itin√©raires";
        }
        
        // Fonction principale de traitement
        function processMessage(userInput) {
            // 1. R√®gles
            let response = ruleBasedResponse(userInput);
            if (response) {
                return { text: response, method: 'rule-based' };
            }
            
            // 2. Recherche par mots-cl√©s (simulation TF-IDF)
            response = keywordMatching(userInput);
            if (response) {
                return { text: response, method: 'keyword-matching' };
            }
            
            // 3. Fallback
            return { text: fallbackResponse(), method: 'fallback' };
        }
        
        // Envoyer un message
        function sendMessage() {
            const input = document.getElementById('userInput');
            const userInput = input.value.trim();
            
            if (!userInput) return;
            
            // Afficher le message utilisateur
            addUserMessage(userInput);
            input.value = '';
            
            // Simuler un d√©lai de r√©flexion
            setTimeout(() => {
                const result = processMessage(userInput);
                addBotMessage(result.text, result.method);
            }, 500);
        }
        
        // Envoyer une question rapide
        function sendQuickQuestion(question) {
            document.getElementById('userInput').value = question;
            sendMessage();
        }
        
        // G√©rer la touche Entr√©e
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }
    </script>
</body>
</html>